<ng-container *ngIf="(homeState$ | async) as state">
  <!-- Main Content -->
  <section class="main-section">
    <app-navbar [user]="state?.appData?.data?.user"></app-navbar>
    <app-stats></app-stats>
    <div class="container mt-3">
      <div class="row">
        <div class="col">
          <h4 class="fw-bold text-start">Recycling Centers ({{ state?.appData?.data?.page?.totalElements }})</h4>
        </div>
        <div class="col text-end">
          <button class="btn btn-success me-2"  (click)="navigateToCreateCenter()">
            <i class="fa-regular fa-square-plus"></i> New Center
          </button>
          <!-- Add a 'View More' button -->
          <button class="btn btn-info me-2" (click)="navigateToCentersView()">
            <i class="fa-solid fa-list-ul"></i> View More
          </button>
        </div>
      </div>

      <!-- Table Section -->
      <div class="table-responsive mt-3">
        <table class="table table-hover">
          <!-- Table Header -->
          <thead class="bg-gradient text-white">
          <tr>
            <th scope="col">Photo</th>
            <th scope="col">Name</th>
            <th scope="col">Contact</th>
            <th scope="col">Location</th>
            <th scope="col">Materials</th>
            <th scope="col">Working Intervals</th>
            <th scope="col">Status</th>
            <th scope="col">Action</th>
          </tr>
          </thead>
          <!-- Table Body -->
          <tbody *ngFor="let center of state?.appData?.data?.page?.content" class="table-body">
          <tr class="cell-1">
            <td><img src="https://robohash.org/recyclingcenter" width="42" height="42" class="rounded-circle"></td>
            <td>{{ center.name }}</td>
            <td>{{ center.county }}</td>
            <td>{{ center.city }}</td>
            <td>
              <div class="accepted-materials">
                <ng-container *ngFor="let material of center | acceptedMaterials">
                  <span class="badge mb-0" [ngClass]="material.badgeClass">{{ material.name }}</span>
                </ng-container>
              </div>
            </td>
            <td>
              <ng-container *ngIf="center.alwaysOpen; else hourInterval">
                Open Always
              </ng-container>
              <ng-template #hourInterval>
                {{ center.openingHour | slice: 0:5 }} - {{ center.closingHour | slice: 0:5 }}
              </ng-template>
            </td>
            <td>
              <span class="badge bg-success">OPEN</span>
            </td>
            <td>
              <button type="button" [routerLink]="['/centers']" class="btn" style="background-color: #63ad6f; color: #fff;">  <i class="fa-solid fa-recycle"></i>  </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <nav *ngIf="state?.appData?.data?.page.totalPages > 0">
        <ngb-pagination
          [(page)]="currentPage"
          [collectionSize]="state?.appData?.data?.page?.totalElements"
          [maxSize]="3"
          [rotate]="true"
          [boundaryLinks]="false"
          [ellipses]="true"
          (pageChange)="goToPage($event)"
          class="pagination justify-content-end"
        >
          <ng-template ngbPaginationPrevious><< Prev</ng-template>
          <ng-template ngbPaginationNext>Next >></ng-template>
        </ngb-pagination>
      </nav>
    </div>
  </section>
</ng-container>
